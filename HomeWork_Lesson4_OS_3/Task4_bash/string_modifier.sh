#!/bin/bash

# //Информация по использованию скрипта\\
# Проверяем, что пользователь передал хотя бы 3 аргумента. Если нет, выводим инструкцию и выходим с кодом 1 (ошибка).
if [ "$#" -lt 3 ]; then
    echo "Использование: $0 <строка> <начальный_индекс> <конечный_индекс> [delete]"
    echo "Где:"
    echo "  <строка>          - строка, из которой нужно извлечь или удалить подстроку. Вводится в двойных ковычках " "."
    echo "  <начальный_индекс> - индекс начального символа подстроки (нумерация начинается с 1)."
    echo "  <конечный_индекс>  - индекс конечного символа подстроки (включительно)."
    echo "  [delete]           - если передан этот параметр, подстрока будет удалена из строки."
    exit 1
fi

# //Получение аргументов\\
# Первый аргумент (строка) сохраняется в переменной input_string
input_string="$1"
# Второй аргумент (начальный индекс) сохраняется в переменной start_index
start_index="$2"
# Третий аргумент (конечный индекс) сохраняется в переменной end_index
end_index="$3"
# Четвёртый аргумент (опциональный) определяет, нужно ли удалить подстроку. Если он не передан, по умолчанию значение будет "false".
delete_substring="${4:-false}"

# //Проверка индексов\\
# Определяем длину строки с помощью ${#input_string}, которая возвращает количество символов в строке.
string_length=${#input_string}

# Проверка: начальный индекс должен быть не меньше 1, конечный индекс не должен быть больше длины строки,
# и начальный индекс должен быть меньше или равен конечному индексу.
if [ "$start_index" -lt 1 ] || [ "$end_index" -gt "$string_length" ] || [ "$start_index" -gt "$end_index" ]; then
    # Если одно из условий неверно, выводим сообщение об ошибке и заканчиваем выполнение скрипта с кодом 1.
    echo "Ошибка: индексы находятся вне допустимого диапазона!"
    echo "Длина строки: $string_length, начальный индекс: $start_index, конечный индекс: $end_index"
    exit 1
fi

# //Извлечение подстроки\\
# Используем команду cut для извлечения подстроки из строки.
# Опция -c указывает, что мы будем извлекать диапазон символов от start_index до end_index.
substring=$(echo "$input_string" | cut -c"$start_index"-"$end_index")

# //Удаление или вывод подстроки\\
# Проверяем, был ли передан четвёртый аргумент "delete".
if [ "$delete_substring" == "delete" ]; then
    # Если аргумент равен "delete", удаляем подстроку из исходной строки.
    # ${input_string//$substring/} заменяет все вхождения подстроки на пустую строку, что фактически удаляет её.
    modified_string="${input_string//$substring/}"
    echo "Строка после удаления подстроки: $modified_string"
else
    # Если четвёртый аргумент не передан или не равен "delete", выводим извлечённую подстроку.
    echo "Извлеченная подстрока: $substring"
fi
